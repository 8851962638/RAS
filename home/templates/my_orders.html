{% extends "base1.html" %}
{% block title %}My Orders - RColourcraft{% endblock %}

{% block content %}
<style>
    /* General Body and Page Container */
    body {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #4b97d1 100%);
        color: #ecf0f1;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    .page-container {
        max-width: 1200px;
        margin: 40px auto;
        padding: 20px;
        flex: 1;
    }

    h1 {
        text-align: center;
        color: #fff;
        margin-bottom: 40px;
        font-size: 2.8em;
        font-weight: 700;
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
        letter-spacing: 1px;
    }

    /* Enhanced Glassmorphism Cards */
    .glass-card {
        background: rgba(255, 255, 255, 0.12);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border-radius: 24px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        padding: 32px;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative;
        overflow: hidden;
    }

    .glass-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #3b82f6, #2563eb, #60a5fa);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .glass-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 16px 48px 0 rgba(31, 38, 135, 0.5);
        border-color: rgba(255, 255, 255, 0.4);
    }

    .glass-card:hover::before {
        opacity: 1;
    }

    /* Grid Layout for Orders */
    .orders-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
        gap: 32px;
        margin-bottom: 60px;
    }

    /* Card Header with Icon */
    .order-card-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid rgba(255, 255, 255, 0.2);
    }

    .order-icon {
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }

    .order-card h3 {
        color: #fff;
        font-size: 1.6em;
        margin: 0;
        font-weight: 600;
        flex: 1;
    }

    /* Info Rows */
    .info-row {
        display: flex;
        align-items: start;
        gap: 12px;
        margin: 14px 0;
        padding: 10px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.05);
        transition: background 0.3s ease;
    }

    .info-row:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    .info-icon {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #93c5fd;
        font-size: 18px;
        flex-shrink: 0;
    }

    .info-content {
        flex: 1;
    }

    .info-label {
        color: #c4b5fd;
        font-size: 0.85em;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 4px;
    }

    .info-value {
        color: #fff;
        font-size: 1em;
        line-height: 1.5;
    }

    /* Status Badge */
    .status-badge {
        display: inline-block;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.9em;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .status-paid {
        background: linear-gradient(135deg, #10b981, #059669);
        color: #fff;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }

    .status-unpaid {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: #fff;
        box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 80px 20px;
        background: rgba(255, 255, 255, 0.12);
        backdrop-filter: blur(15px);
        border-radius: 24px;
        border: 1px solid rgba(255, 255, 255, 0.25);
    }

    .empty-state p {
        color: #e0e7ff;
        font-size: 1.3em;
        margin: 0;
    }

    /* Footer Styling */
    footer {
        margin-top: auto;
        background: rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(10px);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .orders-list {
            grid-template-columns: 1fr;
        }

        h1 {
            font-size: 2.2em;
        }

        .page-container {
            margin: 20px auto;
            padding: 15px;
        }
    }

    /* ===== Toggle Switch ===== */

.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 26px;
    margin-right: 10px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    background-color: #ccc;
    border-radius: 26px;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    transition: 0.3s;
}

.slider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 3px;
    bottom: 3px;
    background: white;
    border-radius: 50%;
    transition: 0.3s;
}

input:checked + .slider {
    background-color: #4caf50;
}

input:checked + .slider:before {
    transform: translateX(24px);
}

.toggle-text {
    font-weight: 600;
}

</style>

<div class="page-container">
    <h1>‚ú® My Previous Orders</h1>

    {% if bookings %}
        <div class="orders-list">
            {% for booking in bookings %}
                <div class="order-card glass-card">
                    <div class="order-card-header">
                        <div class="order-icon">üé®</div>
                        <h3>{{ booking.service_name }}</h3>
                    </div>

                    <div class="info-row">
                        <div class="info-icon">üÜî</div>
                        <div class="info-content">
                            <div class="info-label">Booking ID</div>
                            <div class="info-value">{{ booking.booking_id }}</div>
                        </div>
                    </div>

                <div class="info-row">
                        <div class="info-icon">üìÖ</div>
                        <div class="info-content">
                            <div class="info-label">Booked On</div>
                            <div class="info-value">{{ booking.created_at|date:"d M Y, H:i" }}</div>
                        </div>
                    </div>

              <div class="info-row">
                        <div class="info-icon">üóìÔ∏è</div>
                        <div class="info-content">
                            <div class="info-label">Appointment Date</div>
                            <div class="info-value">{{ booking.appointment_date }}</div>
                        </div>
                    </div>

                    <div class="info-row">
                        <div class="info-icon">üí≥</div>
                        <div class="info-content">
                            <div class="info-label">Payment Status</div>
                            <div class="info-value">
                                {% if booking.is_paid %}
                                    <span class="status-badge status-paid">‚úì Paid ‚Çπ{{ booking.payment_amount }}</span>
                                {% else %}
                                    <span class="status-badge status-unpaid">‚è≥ Not Paid</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-row">
    <div class="info-icon">‚úÖ</div>
    <div class="info-content">
        <div class="info-label">Your Completion Status</div>

        <form method="post" action="{% url 'toggle_customer_status' booking.id %}">
            {% csrf_token %}

            <label class="switch">
                <input type="checkbox"
                       name="customer_status"
                       onchange="this.form.submit()"
                       {% if booking.customer_status %}checked{% endif %}>
                <span class="slider"></span>
            </label>

            <span class="toggle-text">
                {% if booking.customer_status %}
                    Completed
                {% else %}
                    Not Completed
                {% endif %}
            </span>
        </form>
    </div>
</div>


                    <div class="info-row">
                        <div class="info-icon">üìç</div>
                        <div class="info-content">
                            <div class="info-label">Service Address</div>
                            <div class="info-value">
                                {{ booking.address }}<br>
                                {{ booking.city }}, {{ booking.state }} - {{ booking.pin_code }}
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <p>üì¶ You haven't booked any services yet.</p>
        </div>
    {% endif %}
</div>
{% endblock %}